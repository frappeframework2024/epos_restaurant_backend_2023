{% extends "templates/emenu_layout1.html" %}

{% block title %} {{doc.welcome_title}} {% endblock %}

{% block style%}
{{doc.css}}
{% endblock %}

{% block page_content %}
<div class="header">
    <div class="container">
        <div class="d-flex justify-center py-2">
            <div class="logo">
                <img loading="lazy" src="{{p.photo or " /files/no_image.jpg"}}" alt="">
            </div>
        </div>
    </div>
</div>
<div class="section-main-wraper mt-3">
    <div class="container">
        <div class="into-section">
            <h1 class="text-center">
                {% if doc.welcome_title %}
                {{doc.welcome_title}}
                {%endif%}
            </h1>
            <div class="dsc-header">
                {% if doc.welcome_description %}
                {{doc.welcome_description}}
                {%endif%}

            </div>
        </div>
    </div>
    

    <div class="py-3 my-3 nav-pro-wrapper border border-start-0 border-end-0 border-bottom-0 bg-white el-shadow">
        <nav class="container">
            <div class="position-relative">
                <div class="tab-bar">
                    <div class="left-arrow">
                        <p><i class="fas fa-chevron-left"></i></p>
                    </div>

                    <div class="d-flex gap-2 mb-0 navigt tabs">
                        {% if (doc.popular_product | length) >0 %}
                        <a class="bg-white px-3 py-1 rounded-pill main-color nav-pro tab active"
                            href="#popular_product">
                            <p>Popular Products</p>
                        </a>
                        {%endif%}

                        {% for m in doc.pos_menu_selections %}
                        <a class="bg-white px-3 py-1 rounded-pill main-color nav-pro tab" href="#{{m.name}}">
                            <p>{{m.menu}}</p>
                        </a>
                        {%endfor%}
                    </div>

                    <div class="right-arrow active">
                        <p><i class="fas fa-chevron-right"></i></p>
                    </div>
                </div>
            </div>
        </nav>
    </div>

    <div class="container sections-content-1">
        <div class="sections sections-content">
            <div class="scroll-section" id="promo_section">
                {% if (promotion|length) > 0 %}
                    <div class="promo-section mt-4 mb-3">
                        <h1 class="text-center">Promotion</h1> 
                    </div>
                    <div class="justify-center p-4 w-100" style="background: url({{doc.promo_image}});border-radius: 20px;background-repeat: no-repeat;background-size: cover;"> 
                        <div class="owl-carousel owl-theme mb-3" id="slid_banner">
                            {% for p in promotion %}
                                <div class="item d-flex justify-center">
                                    <img class="lazy promo-st" src="{{p.photo or " /files/no_image.jpg"}}"/>
                                </div>
                            {% endfor %} 
                        </div>
                    </div>
                {% endif %}
            </div>
            {% if (popular_products | length) >0 %}
            <div class="scroll-section" id="popular_product">
                <div class="mt-4 mb-3">
                    <h2><i class="fas fa-fire main-color"></i> Popular Products</h2>
                    <p>Our signature dishes</p>
                </div>
                <div class="row p-2">
                    {% for p in popular_products %}
                    <div class="product_detail col-6 col-lg-6 mb-3 text-dark" style="padding-left:5px;padding-right:5px">
                        <div class="col-inner">
                            <a href="/product_detail?emenu_name={{doc.name}}&product_code={{p.product_code}}&category=populars" style="text-decoration: none;">
                                <div class="row p-0 p-lg-3 items-inner-1 m-0 h-100">
                                    <div class="col-12 col-lg-4 p-0 wrapper-image position-relative" style="background: url('/files/food_bg_image.jpg');">
                                        <img loading="lazy" class="img pro-img-it" src="{{p.photo or " /files/no_image.jpg"}}"/>
                                        <div class="position-absolute rounded p-1" style="bottom: 5px; background: #db3c76;right: 5px;">
                                            <p class="text-white" style="font-size:12px;">{{p.product_code}}</p>
                                        </div>
                                        {% if p.is_empty_stock_warning == 1%}
                                            <div class="position-absolute rounded p-1" style="bottom: 5px; background: #db3c76;left: 5px;">
                                                <p class="text-white" style="font-size:12px;">* Out of Order</p>
                                            </div>                                       
                                        {% endif %}
                                        {% if p.discount_value > 0 %}
                                            <div class="position-absolute rounded p-1" style="top: 5px; background: #db3c76;left: 5px;">
                                                {% if p.prices != [] %}
                                                    {% for price in p.prices %}
                                                        {% if loop.index == 1 %}
                                                            {% if p.discount_value > 0 %}
                                                                {% if p.discount_type == 'Percent' %}
                                                                    {% set dis_value = p.discount_value %}
                                                                        <p class="text-white">{{ dis_value | int }}% Off</p>
                                                                    {% else %}
                                                                    <p class="text-white">{{ frappe.format(p.discount_value, {"fieldtype": "Currency"}) }} Off</p>
                                                                    {% endif %}
                                                            {% endif %}
                                                        {% endif %}
                                                    {% endfor %}
                                                {% else %}
                                                    {% if p.discount_value > 0 %}
                                                        {% if p.discount_type=='Percent' %}
                                                            {% set dis_value = p.discount_value %}
                                                            <p class="text-white">{{ dis_value | int }}% Off</p>
                                                        {% else %}
                                                            <p class="text-white">{{ frappe.format(p.discount_value,{"fieldtype":"Currency"})}} Off</p>
                                                        {% endif %}
                                                    {% endif %}
                                                {% endif %}
                                            </div>
                                        {% endif %}
                                        
                                    </div>
                                    <div class="col-12 col-lg-8 d-flex flex-column flex-lg-column py-3 ps-lg-3 py-lg-0 content-custom">
                                        <div class="">
                                            <div class="mb-3 mb-lg-0">
                                                {% if p.product_name_en == p.product_name_kh %}                                    
                                                    <div class="item-tt-txt" style="color: {{doc.kh_title_color}};">{{p.product_name_kh}}</div>
                                                {%else%}
                                                    <div title="{{p.product_name_kh}}" class="item-tt-txt" style="color: {{doc.kh_title_color}};">{{p.product_name_kh}}</div>
                                                    <div title="{{p.product_name_en}}" class="item-tt-txt en" style="color: {{doc.en_title_color}};">{{p.product_name_en}}</div>
                                                {%endif%} 
                                            </div>
                                            {% if p.description %}
                                                <div class="description-cs">{{p.description}}</div>
                                            {% endif %}
                                        </div>
                                        <div class="d-block d-xl-flex justify-between"> 
                                            <div class="cnter-txt mt-3 mt-lg-0">
                                                {% if p.prices != [] %}
                                                    {% for price in p.prices %}                                                     
                                                        {% if p.discount_value > 0 %}
                                                            <div><span class="price-cus portion">{{price.portion}}</span></div>
                                                            <div class="d-flex gap-2 justify-center price-portion">    
                                                                <del class="price-cus" style="color:#ccc">{{frappe.format(price.price or 0,{"fieldtype":"Currency"})}}</del>
                                                                {% if p.discount_type=='Percent' %}
                                                                    <p class="price-cus">{{frappe.format((price.price or 0) - ((price.price or 0)* (p.discount_value/100) ),{"fieldtype":"Currency"})}}</p>
                                                                {% else %}
                                                                    <p class="price-cus">{{frappe.format((price.price or 0) - (p.discount_value) ,{"fieldtype":"Currency"})}}</p>
                                                                {%endif%}
                                                            </div>
                                                        {% else %}
                                                            <p class="price-cus portion">{{price.portion}}: 
                                                                {{frappe.format(price.price or 0,{"fieldtype":"Currency"})}}
                                                            </p>
                                                        {% endif %}                          
                                                    {% endfor %}
                                                {% else %}
                                                    <div class="flex gap-2 justify-center"> 
                                                        {% if p.discount_value > 0 %}
                                                            <del class="price-cus" style="color: #ccc;">{{frappe.format(p.price,{"fieldtype":"Currency"})}}</del>
                                                            {% if p.discount_type=='Percent' %}
                                                                <p class="price-cus">{{frappe.format((p.price or  0) - ((p.price or 0)* (p.discount_value/100) ),{"fieldtype":"Currency"})}}</p>
                                                            {%else%}
                                                                <p class="price-cus">{{frappe.format((p.price or 0) - (p.discount_value) ,{"fieldtype":"Currency"})}}</p>
                                                            {%endif%}
                                                        {% else %}
                                                            <p class="price-cus">{{frappe.format(p.price,{"fieldtype":"Currency"})}}</p>
                                                        {% endif %}
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                    {%endfor%}
                </div>
            </div>
            {%endif%}
            {% for m in doc.pos_menu_selections %}
            <div class="scroll-section" id="{{m.name}}">
                <div class="mt-4 mb-3">
                    {% set title = m.menu %}
                    <h2>{{title.split('(')[0]}}</h2>
                </div>
                <div class="row p-2">
                    {%for p in products|selectattr('pos_menu', 'equalto', m.menu)|list %}
                    <div class="product_detail col-6 col-lg-6 mb-3 text-dark" style="padding-left:5px;padding-right:5px">
                        <div class="col-inner"> 
                            <a href="/product_detail?emenu_name={{doc.name}}&product_code={{p.product_code}}&category={{p.name}}" style="text-decoration: none;">
                                <div class="row p-0 p-lg-3 items-inner-1 m-0 h-100">
                                    <div class="col-12 col-lg-4 p-0 wrapper-image" style="background: url('/files/food_bg_image.jpg');">
                                        <img loading="lazy" class="img pro-img-it" src="{{p.photo or " /files/no_image.jpg"}}"/>
                                        <div class="position-absolute rounded p-1" style="bottom: 5px; background: #db3c76;right: 5px;">
                                            <p class="text-white" style="font-size:12px;">{{p.product_code}}</p>
                                        </div>
                                            {% if p.is_empty_stock_warning == 1%}
                                                <div class="position-absolute rounded p-1" style="bottom: 5px; background: #db3c76;left: 5px;">
                                                        <p class="text-white" style="font-size:12px;">* Out of Order</p>
                                                </div>
                                            {% endif %}
                                       
                                            {% if p.discount_value > 0 %}
                                                <div class="position-absolute rounded p-1" style="top: 5px; background: #db3c76;left: 5px;">
                                                    {% if p.prices != [] %}
                                                        {% for price in p.prices %}
                                                            {% if loop.index == 1 %}
                                                                {% if p.discount_value > 0 %}
                                                                    {% if p.discount_type == 'Percent' %}
                                                                        {% set dis_value = p.discount_value %}
                                                                        <p class="text-white">{{ dis_value | int }}% Off</p>
                                                                    {% else %}
                                                                        <p class="text-white">{{ frappe.format(p.discount_value, {"fieldtype": "Currency"}) }} Off</p>
                                                                    {% endif %}
                                                                {% endif %}
                                                            {% endif %}
                                                        {% endfor %}
                                                    {% else %}
                                                        {% if p.discount_value > 0 %}
                                                            {% if p.discount_type=='Percent' %}
                                                                {% set dis_value = p.discount_value %}
                                                                <p class="text-white">{{ dis_value | int }}% Off</p>
                                                            {% else %}
                                                                <p class="text-white">{{ frappe.format(p.discount_value,{"fieldtype":"Currency"})}} Off</p>
                                                            {% endif %}
                                                        {% endif %}
                                                    {% endif %}
                                                </div>
                                            {% endif %}
                                        
                                    </div>
                                    <div class="col-12 col-lg-8 d-flex flex-column flex-lg-column py-3 ps-lg-3 py-lg-0 content-custom">
                                        <div class=""> 
                                            <div class="mb-3 mb-lg-0">
                                                {% if p.product_name_en == p.product_name_kh %}
                                                <div class="item-tt-txt" style="color: {{doc.kh_title_color}};">{{p.product_name_kh}}</div>
                                                {%else%}
                                                <div title="{{p.product_name_kh}}" class="item-tt-txt" style="color: {{doc.kh_title_color}};">{{p.product_name_kh}}</div>
                                                <div title="{{p.product_name_en}}" class="item-tt-txt en" style="color: {{doc.en_title_color}};">{{p.product_name_en}} </div>
                                                {%endif%} 
                                            </div>
                                            {% if p.description %}
                                                <div class="description-cs">{{p.description}}</div>
                                            {% endif %}
                                        </div>
                                        <div class="d-block d-xl-flex justify-between">
                                            <div class="cnter-txt mt-3 mt-lg-0">
                                                {% if p.prices != [] %}
                                                    {% for price in p.prices %}
                                                            {% if p.discount_value > 0 %}
                                                                <div><span class="price-cus portion">{{price.portion}}</span></div>
                                                                <div class="d-flex gap-2 justify-center price-portion">    
                                                                    <del class="price-cus" style="color:#ccc">{{frappe.format(price.price or 0,{"fieldtype":"Currency"})}}</del>
                                                                    {% if p.discount_type=='Percent' %}
                                                                        <p class="price-cus">{{frappe.format((price.price or 0) - ((price.price or 0)* (p.discount_value/100) ),{"fieldtype":"Currency"})}}</p>
                                                                    {% else %}
                                                                        <p class="price-cus">{{frappe.format((price.price or 0) - (p.discount_value) ,{"fieldtype":"Currency"})}}</p>
                                                                    {%endif%}
                                                                </div>
                                                            {% else %}
                                                                <p class="price-cus portion">{{price.portion}}: 
                                                                    {{frappe.format(price.price or 0,{"fieldtype":"Currency"})}}
                                                                </p>
                                                            {% endif %}
                                                      
                                                    {% endfor %}
                                                {% else %}
                                                    <div class="flex gap-2 justify-center">
                                                            {% if p.discount_value > 0 %}
                                                                <del class="price-cus" style="color: #ccc;">{{frappe.format(p.price,{"fieldtype":"Currency"})}}</del>
                                                                {% if p.discount_type=='Percent' %}
                                                                    <p class="price-cus">{{frappe.format((p.price or  0) - ((p.price or 0)* (p.discount_value/100) ),{"fieldtype":"Currency"})}}</p>
                                                                {%else%}
                                                                    <p class="price-cus">{{frappe.format((p.price or 0) - (p.discount_value) ,{"fieldtype":"Currency"})}}</p>
                                                                {%endif%}
                                                            {% else %}
                                                                <p class="price-cus">{{frappe.format(p.price,{"fieldtype":"Currency"})}}</p>
                                                            {% endif %}
                                                       
                                                        
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                    {%endfor%}
                </div>
            </div>
            {%endfor%}
        </div>
    </div>


    <div class="container footer-section">
        <hr />
        {% if doc.footer_description %}
        <h1>{{doc.footer_description }}</h1>
        {%endif%}
        <hr />
        <p class="text-center mb-3">Design by: eSTC</p>
    </div>
</div>
{% endblock %}