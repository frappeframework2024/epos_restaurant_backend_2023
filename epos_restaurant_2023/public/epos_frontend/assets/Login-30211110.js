import{_ as q,i as H,a as w,u as T,b as F,c as G,r as K,d as k,o as Q,e as X,w as i,f as g,g as $,h as o,j as s,k as t,t as _,n as Y,l as Z,m as r,p as ee,q as se,s as te,v as oe,x as y,A as ne}from"./index-7fadd29c.js";const ie=f=>(te("data-v-fd88618d"),f=f(),oe(),f),le={class:"h-full w-full p-10 flex justify-center items-center position-relative"},ae=ie(()=>s("div",{class:"position-absolute",style:{top:"50px"}},null,-1)),re={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},de={class:"mb-3"},ce=["src"],ue={class:"font-bold mb-3"},pe={class:"py-3"},_e={class:"h-full flex items-center justify-center bg-gray-100"},me=["onSubmit"],ge={class:"w-73"},fe={class:"d-block d-md-none mt-4"},ve={class:"mb-3"},be=["src"],we={class:"text-center mb-3"},he={class:"font-bold mb-1 text-2xl"},xe={class:"text-sm"},ke={class:"mb-3"},ye={class:"relative"},Ce={class:"grid grid-cols-3 gap-3"},Se={class:"mt-4"},$e={class:"mt-2"},Ie={class:"mt-4 text-center"},Le={class:"text-sm text-green-700"},ze={class:"text-sm text-red-700"},Ne={key:0,class:"fixed bottom-8"},Pe={__name:"Login",setup(f){const{t:u}=H.global,I=w("$auth"),v=w("$pos_license"),C=w("$gv"),L=w("$sale"),{mobile:z}=T(),h=ne({position:"top"}),N=F(),m=G();m.state.isLoading=!1;let l=K({username:"",password:""});const c=k(()=>JSON.parse(localStorage.getItem("setting"))),P=k(()=>m.state.isLoading),V=k(()=>localStorage.getItem("device_name"));Q(()=>{localStorage.removeItem("current_user"),localStorage.removeItem("make_order_auth")});function B(n){localStorage.setItem("lang",n),location.reload()}function p(n){l.password==null&&(l.password=""),l.password=l.password+n}function E(){l.password=""}function j(){return localStorage.getItem("is_window")=="1"}function D(){l.password=l.password.substring(0,l.password.length-1)}const O=async()=>{if(v.web_platform&&!v.license.status)return;if(!l.password){h.warning(u("msg.Invalid PIN Code"),{position:"top"});return}m.dispatch("startLoading");let n=!1;y({url:"epos_restaurant_2023.api.api.check_username",auto:!0,params:{pin_code:l.password},async onSuccess(e){m.dispatch("startLoading"),l.username=e.username,l.username&&l.password&&(await I.login(l.username,l.password)?(A(e),J()):(h.warning("msg.Login fail Invalid username or password"),m.dispatch("endLoading")))},onError(e){n||(n=!0,m.dispatch("endLoading"),h.warning(u("msg.Invalid PIN Code"),{position:"top"}))}})};function A(n){y({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,async onSuccess(e){e.permission=n.permission,localStorage.setItem("current_user",JSON.stringify(e)),N.push({name:"Home"}),m.dispatch("endLoading")},onError(e){m.dispatch("endLoading")}})}function J(){y({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:C.setting.business_branch},onSuccess(n){C.promotion=n,L.promotion=n}})}function M(){const n={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(n))}return(n,e)=>{const x=g("v-divider"),b=g("v-list-item"),R=g("v-list"),S=g("v-col"),U=g("v-text-field"),a=g("v-btn"),W=g("v-row");return $(),X(W,{class:"mt-0 mb-0 h-screen"},{default:i(()=>[o(S,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:i(()=>[s("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:Y({"background-image":"url("+t(c)?.login_background+")"})},[s("div",le,[ae,s("div",null,[s("div",re,[s("div",de,[s("img",{class:"my-0 mx-auto",src:t(c)?.logo,style:{"max-height":"150px"}},null,8,ce)]),s("h1",ue,_(t(c)?.app_name),1),o(x),s("div",pe,[o(R,{lines:"one","bg-color":"transparent"},{default:i(()=>[o(b,{class:"mb-2",title:t(c)?.business_branch,subtitle:t(u)("Business")},null,8,["title","subtitle"]),o(b,{class:"mb-2",title:t(c)?.pos_profile,subtitle:t(u)("POS Profile")},null,8,["title","subtitle"]),o(b,{class:"mb-2",title:t(c)?.phone_number,subtitle:t(u)("Phone Number")},null,8,["title","subtitle"]),o(b,{title:t(c)?.address,subtitle:t(u)("Address")},null,8,["title","subtitle"])]),_:1})])])])])],4)]),_:1}),o(S,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:i(()=>[s("div",_e,[s("form",{onSubmit:Z(O,["prevent"])},[s("div",ge,[s("div",null,[s("div",fe,[s("div",ve,[s("img",{class:"my-0 mx-auto w-16",src:t(c)?.logo},null,8,be)]),s("div",we,[s("h1",he,_(t(c)?.app_name),1),s("p",xe,_(t(c)?.business_branch),1),o(x)])]),s("div",ke,[s("div",ye,[o(U,{readonly:t(z),type:"password",density:"compact",variant:"solo",autofocus:"",label:t(u)("Password"),"append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:t(l).password,"onUpdate:modelValue":e[0]||(e[0]=d=>t(l).password=d),height:"200","onClick:appendInner":e[1]||(e[1]=d=>D())},null,8,["readonly","label","modelValue"])])]),s("div",null,[s("div",Ce,[o(a,{onClick:e[2]||(e[2]=d=>p("1")),size:"x-large"},{default:i(()=>[r(" 1 ")]),_:1}),o(a,{onClick:e[3]||(e[3]=d=>p("2")),size:"x-large"},{default:i(()=>[r(" 2 ")]),_:1}),o(a,{onClick:e[4]||(e[4]=d=>p("3")),size:"x-large"},{default:i(()=>[r(" 3 ")]),_:1}),o(a,{onClick:e[5]||(e[5]=d=>p("4")),size:"x-large"},{default:i(()=>[r(" 4 ")]),_:1}),o(a,{onClick:e[6]||(e[6]=d=>p("5")),size:"x-large"},{default:i(()=>[r(" 5 ")]),_:1}),o(a,{onClick:e[7]||(e[7]=d=>p("6")),size:"x-large"},{default:i(()=>[r(" 6 ")]),_:1}),o(a,{onClick:e[8]||(e[8]=d=>p("7")),size:"x-large"},{default:i(()=>[r(" 7 ")]),_:1}),o(a,{onClick:e[9]||(e[9]=d=>p("8")),size:"x-large"},{default:i(()=>[r(" 8 ")]),_:1}),o(a,{onClick:e[10]||(e[10]=d=>p("9")),size:"x-large"},{default:i(()=>[r(" 9 ")]),_:1}),o(a,{onClick:e[11]||(e[11]=d=>p("0")),size:"x-large"},{default:i(()=>[r(" 0 ")]),_:1}),o(a,{class:"col-span-2",color:"error",onClick:E,size:"x-large"},{default:i(()=>[r(_(t(u)("Clear")),1)]),_:1})])]),s("div",Se,[o(a,{type:"submit",loading:t(P),size:"x-large",class:"w-full",color:"primary",disabled:t(v).web_platform&&!(t(v).license?.status??!1)},{default:i(()=>[r(_(t(u)("Login")),1)]),_:1},8,["loading","disabled"])]),s("div",$e,[o(a,{size:"x-large",class:"w-full",color:"light",onClick:e[12]||(e[12]=()=>{n.$i18n.locale=n.$i18n.locale=="kh"?"en":"kh",B(n.$i18n.locale)})},{default:i(()=>[r(_(n.$i18n.locale=="en"?"ខ្មែរ":"English"),1)]),_:1})]),s("div",Ie,[s("p",Le,_(t(c)?.pos_profile),1),s("p",ze,_(t(V)),1)])])])],40,me),j()?($(),ee("div",Ne,[o(a,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[13]||(e[13]=d=>M())},{default:i(()=>[r(_(t(u)("Exit")),1)]),_:1})])):se("",!0)])]),_:1})]),_:1})}}},Be=q(Pe,[["__scopeId","data-v-fd88618d"]]);export{Be as default};
