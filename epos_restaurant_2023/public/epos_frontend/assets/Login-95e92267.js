import{_ as q,i as H,a as b,u as T,b as G,c as K,r as Q,d as k,o as X,e as Y,w as i,f as g,g as w,h as o,j as t,k as s,t as _,n as Z,l as ee,m as y,p as C,F as se,q as r,s as $,A as te}from"./index-22c15b67.js";const oe={class:"h-full w-full p-10 flex justify-center items-center"},ne={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},ie={class:"mb-3"},le=["src"],ae={class:"font-bold mb-3"},re={class:"py-3"},de={class:"h-full flex items-center justify-center bg-gray-100"},ce=["onSubmit"],ue={key:0,class:"flex items-center justify-center p-2 mb-4 bg-red-100 text-red"},me={class:"w-73"},_e={class:"d-block d-md-none mt-4"},pe={class:"mb-3"},ge=["src"],fe={class:"text-center mb-3"},ve={class:"font-bold mb-1 text-2xl"},be={class:"text-sm"},we={class:"mb-3"},he={class:"relative"},xe={class:"grid grid-cols-3 gap-3"},ke={class:"mt-4"},ye={class:"mt-2"},Ce={class:"mt-4 text-center"},$e={class:"text-sm text-green-700"},Se={class:"text-sm text-red-700"},Le={key:0,class:"fixed bottom-8"},ze={__name:"Login",setup(Ie){const{t:u}=H.global,z=b("$auth"),f=b("$pos_license"),S=b("$gv"),I=b("$sale"),{mobile:N}=T(),h=te({position:"top"}),P=G(),p=K();p.state.isLoading=!1;let l=Q({username:"",password:""});const c=k(()=>JSON.parse(localStorage.getItem("setting"))),V=k(()=>p.state.isLoading),B=k(()=>localStorage.getItem("device_name"));X(()=>{localStorage.removeItem("current_user"),localStorage.removeItem("make_order_auth")});function E(n){localStorage.setItem("lang",n),location.reload()}function m(n){l.password==null&&(l.password=""),l.password=l.password+n}function j(){l.password=""}function D(){return localStorage.getItem("is_window")=="1"}function O(){l.password=l.password.substring(0,l.password.length-1)}const A=async()=>{if(!f.license.status)return;if(!l.password){h.warning(u("msg.Invalid PIN Code"),{position:"top"});return}p.dispatch("startLoading");let n=!1;$({url:"epos_restaurant_2023.api.api.check_username",auto:!0,params:{pin_code:l.password},async onSuccess(e){p.dispatch("startLoading"),l.username=e.username,l.username&&l.password&&(await z.login(l.username,l.password)?(J(e),M()):(h.warning("msg.Login fail Invalid username or password"),p.dispatch("endLoading")))},onError(e){n||(n=!0,p.dispatch("endLoading"),h.warning(u("msg.Invalid PIN Code"),{position:"top"}))}})};function J(n){$({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,async onSuccess(e){e.permission=n.permission,localStorage.setItem("current_user",JSON.stringify(e)),P.push({name:"Home"}),p.dispatch("endLoading")},onError(e){p.dispatch("endLoading")}})}function M(){$({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:S.setting.business_branch},onSuccess(n){S.promotion=n,I.promotion=n}})}function F(){const n={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(n))}return(n,e)=>{const x=g("v-divider"),v=g("v-list-item"),R=g("v-list"),L=g("v-col"),U=g("v-text-field"),a=g("v-btn"),W=g("v-row");return w(),Y(W,{class:"mt-0 mb-0 h-screen"},{default:i(()=>[o(L,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:i(()=>[t("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:Z({"background-image":"url("+s(c)?.login_background+")"})},[t("div",oe,[t("div",null,[t("div",ne,[t("div",ie,[t("img",{class:"my-0 mx-auto",src:s(c)?.logo,style:{"max-height":"150px"}},null,8,le)]),t("h1",ae,_(s(c)?.app_name),1),o(x),t("div",re,[o(R,{lines:"one","bg-color":"transparent"},{default:i(()=>[o(v,{class:"mb-2",title:s(c)?.business_branch,subtitle:s(u)("Business")},null,8,["title","subtitle"]),o(v,{class:"mb-2",title:s(c)?.pos_profile,subtitle:s(u)("POS Profile")},null,8,["title","subtitle"]),o(v,{class:"mb-2",title:s(c)?.phone_number,subtitle:s(u)("Phone Number")},null,8,["title","subtitle"]),o(v,{title:s(c)?.address,subtitle:s(u)("Address")},null,8,["title","subtitle"])]),_:1})])])])])],4)]),_:1}),o(L,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:i(()=>[t("div",de,[t("form",{onSubmit:ee(A,["prevent"])},[s(f).license!=null?(w(),y(se,{key:0},[s(f).license.show_license_msg?(w(),y("div",ue,_(s(f).license.message),1)):C("",!0)],64)):C("",!0),t("div",me,[t("div",null,[t("div",_e,[t("div",pe,[t("img",{class:"my-0 mx-auto w-16",src:s(c)?.logo},null,8,ge)]),t("div",fe,[t("h1",ve,_(s(c)?.app_name),1),t("p",be,_(s(c)?.business_branch),1),o(x)])]),t("div",we,[t("div",he,[o(U,{readonly:s(N),type:"password",density:"compact",variant:"solo",autofocus:"",label:s(u)("Password"),"append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:s(l).password,"onUpdate:modelValue":e[0]||(e[0]=d=>s(l).password=d),height:"200","onClick:appendInner":e[1]||(e[1]=d=>O())},null,8,["readonly","label","modelValue"])])]),t("div",null,[t("div",xe,[o(a,{onClick:e[2]||(e[2]=d=>m("1")),size:"x-large"},{default:i(()=>[r(" 1 ")]),_:1}),o(a,{onClick:e[3]||(e[3]=d=>m("2")),size:"x-large"},{default:i(()=>[r(" 2 ")]),_:1}),o(a,{onClick:e[4]||(e[4]=d=>m("3")),size:"x-large"},{default:i(()=>[r(" 3 ")]),_:1}),o(a,{onClick:e[5]||(e[5]=d=>m("4")),size:"x-large"},{default:i(()=>[r(" 4 ")]),_:1}),o(a,{onClick:e[6]||(e[6]=d=>m("5")),size:"x-large"},{default:i(()=>[r(" 5 ")]),_:1}),o(a,{onClick:e[7]||(e[7]=d=>m("6")),size:"x-large"},{default:i(()=>[r(" 6 ")]),_:1}),o(a,{onClick:e[8]||(e[8]=d=>m("7")),size:"x-large"},{default:i(()=>[r(" 7 ")]),_:1}),o(a,{onClick:e[9]||(e[9]=d=>m("8")),size:"x-large"},{default:i(()=>[r(" 8 ")]),_:1}),o(a,{onClick:e[10]||(e[10]=d=>m("9")),size:"x-large"},{default:i(()=>[r(" 9 ")]),_:1}),o(a,{onClick:e[11]||(e[11]=d=>m("0")),size:"x-large"},{default:i(()=>[r(" 0 ")]),_:1}),o(a,{class:"col-span-2",color:"error",onClick:j,size:"x-large"},{default:i(()=>[r(_(s(u)("Clear")),1)]),_:1})])]),t("div",ke,[o(a,{type:"submit",loading:s(V),size:"x-large",class:"w-full",color:"primary",disabled:!s(f).license.status},{default:i(()=>[r(_(s(u)("Login")),1)]),_:1},8,["loading","disabled"])]),t("div",ye,[o(a,{size:"x-large",class:"w-full",color:"light",onClick:e[12]||(e[12]=()=>{n.$i18n.locale=n.$i18n.locale=="kh"?"en":"kh",E(n.$i18n.locale)})},{default:i(()=>[r(_(n.$i18n.locale=="en"?"ខ្មែរ":"English"),1)]),_:1})]),t("div",Ce,[t("p",$e,_(s(c)?.pos_profile),1),t("p",Se,_(s(B)),1)])])])],40,ce),D()?(w(),y("div",Le,[o(a,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[13]||(e[13]=d=>F())},{default:i(()=>[r(_(s(u)("Exit")),1)]),_:1})])):C("",!0)])]),_:1})]),_:1})}}},Pe=q(ze,[["__scopeId","data-v-ba1490df"]]);export{Pe as default};
