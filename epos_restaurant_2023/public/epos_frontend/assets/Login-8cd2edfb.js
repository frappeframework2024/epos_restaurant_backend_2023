import{_ as ee,i as h,a as se,u as te,b as oe,c as ne,r as B,d as le,e as C,o as ae,f as v,g as E,w as n,h as m,j as t,k as o,l as s,t as u,n as ie,m as re,p as r,q as y,s as de,F as ce,v as ue,x as V,y as _e,z as pe,A as me,B as D,C as ge}from"./index-8d620513.js";const fe=w=>(_e("data-v-6c09660a"),w=w(),pe(),w),ve={class:"h-full w-full p-10 flex justify-center items-center position-relative"},be=fe(()=>o("div",{class:"position-absolute",style:{top:"50px"}},null,-1)),he={class:"app-info w-96 inline-block text-center rounded-lg pa-4 bg-gradient-to-t from-yellow-900 to-yellow-700 text-white shadow-sm"},we={class:"mb-3"},xe=["src"],ke={class:"font-bold mb-3"},ye={class:"py-3"},Ce={class:"h-full flex items-center justify-center bg-gray-100"},Se=["onSubmit"],$e={class:"w-73"},Ie={class:"d-block d-md-none mt-4"},Le={class:"mb-3"},ze=["src"],Ne={class:"text-center mb-3"},Pe={class:"font-bold mb-1 text-2xl"},Be={class:"text-sm"},Ee={class:"mb-3"},Ve={class:"relative"},De={class:"grid grid-cols-3 gap-3"},Oe={class:"mt-4"},je={key:0,class:"mt-2"},Ae={key:1,class:"mt-2"},Je={class:"mt-4 text-center"},Me={class:"text-sm text-green-700"},Fe={class:"text-sm text-red-700"},Re={key:0,class:"fixed bottom-8"},Te={__name:"Login",setup(w){const O=h("$frappe").db(),{t:p}=se.global,j=h("$auth"),f=h("$pos_license"),S=h("$gv"),A=h("$sale"),{mobile:J}=te(),$=ge({position:"top"}),M=oe(),g=ne(),x=B(),k=B("");g.state.isLoading=!1;let i=le({username:"",password:""});const c=C(()=>JSON.parse(localStorage.getItem("setting"))),F=C(()=>g.state.isLoading),R=C(()=>localStorage.getItem("device_name"));ae(()=>{localStorage.removeItem("current_user"),localStorage.removeItem("make_order_auth"),O.getDocList("POS Translation",{fields:["name","language_name","flag"]}).then(l=>{x.value=l}),k.value=localStorage.getItem("__language_name")});function I(l,e){localStorage.setItem("__language_name",e),localStorage.setItem("lang",l),k.value!=e&&location.reload()}function _(l){i.password==null&&(i.password=""),i.password=i.password+l}function T(){i.password=""}function U(){return localStorage.getItem("is_window")=="1"}function W(){i.password=i.password.substring(0,i.password.length-1)}const q=async()=>{if(!(f.web_platform&&(!f.license.status||(f.license?.expired??!1)))){if(!i.password){$.warning(p("msg.Invalid PIN Code"),{position:"top"});return}g.dispatch("startLoading"),me("api.check_username",{pin_code:i.password}).then(async l=>{g.dispatch("startLoading"),i.username=l.message.username,i.username&&i.password&&(await j.login(i.username,i.password)?(H(l.message),G()):($.warning("msg.Login fail Invalid username or password"),g.dispatch("endLoading")))}).catch(l=>{g.dispatch("endLoading")})}};function H(l){D({url:"epos_restaurant_2023.api.api.get_user_information",auto:!0,async onSuccess(e){e.permission=l.permission,localStorage.setItem("current_user",JSON.stringify(e)),M.push({name:"Home"}),g.dispatch("endLoading")},onError(e){g.dispatch("endLoading")}})}function G(){D({url:"epos_restaurant_2023.api.promotion.check_promotion",cache:"check_promotion",auto:!0,params:{business_branch:S.setting.business_branch},onSuccess(l){S.promotion=l,A.promotion=l}})}function K(){const l={action:"exit"};window.chrome.webview.postMessage(JSON.stringify(l))}return(l,e)=>{const L=m("v-divider"),b=m("v-list-item"),z=m("v-list"),N=m("v-col"),Q=m("v-text-field"),d=m("v-btn"),X=m("v-list-item-title"),Y=m("v-menu"),Z=m("v-row");return v(),E(Z,{class:"mt-0 mb-0 h-screen"},{default:n(()=>[t(N,{md:"6",lg:"8",class:"pa-0 d-sm-none d-none d-md-block"},{default:n(()=>[o("div",{class:"h-screen bg-cover bg-no-repeat bg-center",style:ie({"background-image":"url("+s(c)?.login_background+")"})},[o("div",ve,[be,o("div",null,[o("div",he,[o("div",we,[o("img",{class:"my-0 mx-auto",src:s(c)?.logo,style:{"max-height":"150px"}},null,8,xe)]),o("h1",ke,u(s(c)?.app_name),1),t(L),o("div",ye,[t(z,{lines:"one","bg-color":"transparent"},{default:n(()=>[t(b,{class:"mb-2",title:s(c)?.business_branch,subtitle:s(p)("Business")},null,8,["title","subtitle"]),t(b,{class:"mb-2",title:s(c)?.pos_profile,subtitle:s(p)("POS Profile")},null,8,["title","subtitle"]),t(b,{class:"mb-2",title:s(c)?.phone_number,subtitle:s(p)("Phone Number")},null,8,["title","subtitle"]),t(b,{title:s(c)?.address,subtitle:s(p)("Address")},null,8,["title","subtitle"])]),_:1})])])])])],4)]),_:1}),t(N,{sm:"12",md:"6",lg:"4",class:"pa-0 relative"},{default:n(()=>[o("div",Ce,[o("form",{onSubmit:re(q,["prevent"])},[o("div",$e,[o("div",null,[o("div",Ie,[o("div",Le,[o("img",{class:"my-0 mx-auto w-16",src:s(c)?.logo},null,8,ze)]),o("div",Ne,[o("h1",Pe,u(s(c)?.app_name),1),o("p",Be,u(s(c)?.business_branch),1),t(L)])]),o("div",Ee,[o("div",Ve,[t(Q,{readonly:s(J),type:"password",density:"compact",variant:"solo",autofocus:"",label:s(p)("Password"),"append-inner-icon":"mdi-arrow-left","single-line":"","hide-details":"",modelValue:s(i).password,"onUpdate:modelValue":e[0]||(e[0]=a=>s(i).password=a),height:"200","onClick:appendInner":e[1]||(e[1]=a=>W())},null,8,["readonly","label","modelValue"])])]),o("div",null,[o("div",De,[t(d,{onClick:e[2]||(e[2]=a=>_("1")),size:"x-large"},{default:n(()=>[r(" 1 ")]),_:1}),t(d,{onClick:e[3]||(e[3]=a=>_("2")),size:"x-large"},{default:n(()=>[r(" 2 ")]),_:1}),t(d,{onClick:e[4]||(e[4]=a=>_("3")),size:"x-large"},{default:n(()=>[r(" 3 ")]),_:1}),t(d,{onClick:e[5]||(e[5]=a=>_("4")),size:"x-large"},{default:n(()=>[r(" 4 ")]),_:1}),t(d,{onClick:e[6]||(e[6]=a=>_("5")),size:"x-large"},{default:n(()=>[r(" 5 ")]),_:1}),t(d,{onClick:e[7]||(e[7]=a=>_("6")),size:"x-large"},{default:n(()=>[r(" 6 ")]),_:1}),t(d,{onClick:e[8]||(e[8]=a=>_("7")),size:"x-large"},{default:n(()=>[r(" 7 ")]),_:1}),t(d,{onClick:e[9]||(e[9]=a=>_("8")),size:"x-large"},{default:n(()=>[r(" 8 ")]),_:1}),t(d,{onClick:e[10]||(e[10]=a=>_("9")),size:"x-large"},{default:n(()=>[r(" 9 ")]),_:1}),t(d,{onClick:e[11]||(e[11]=a=>_("0")),size:"x-large"},{default:n(()=>[r(" 0 ")]),_:1}),t(d,{class:"col-span-2",color:"error",onClick:T,size:"x-large"},{default:n(()=>[r(u(s(p)("Clear")),1)]),_:1})])]),o("div",Oe,[t(d,{type:"submit",loading:s(F),size:"x-large",class:"w-full",color:"primary",disabled:s(f).web_platform&&(!(s(f).license?.status??!1)||(s(f).license?.expired??!1))},{default:n(()=>[r(u(s(p)("Login")),1)]),_:1},8,["loading","disabled"])]),s(x)?.length<=2?(v(),y("div",je,[t(d,{size:"x-large",class:"w-full",color:"light",onClick:e[12]||(e[12]=()=>{l.$i18n.locale=l.$i18n.locale=="kh"?"en":"km",I(l.$i18n.locale)})},{default:n(()=>[r(u(l.$i18n.locale=="en"?"ខ្មែរ":"English"),1)]),_:1})])):s(x)?.length>=3?(v(),y("div",Ae,[t(Y,null,{activator:n(({props:a})=>[t(d,de({size:"x-large",class:"w-full",color:"light"},a),{default:n(()=>[r(u(s(k)==null?(l.$i18n.locale=="en","English"):s(k)),1)]),_:2},1040)]),default:n(()=>[t(z,null,{default:n(()=>[(v(!0),y(ce,null,ue(s(x),(a,P)=>(v(),E(b,{onClick:We=>I(a.name,a.language_name),key:P,value:P},{default:n(()=>[t(X,null,{default:n(()=>[r(u(a.language_name),1)]),_:2},1024)]),_:2},1032,["onClick","value"]))),128))]),_:1})]),_:1})])):V("",!0),o("div",Je,[o("p",Me,u(s(c)?.pos_profile),1),o("p",Fe,u(s(R)),1)])])])],40,Se),U()?(v(),y("div",Re,[t(d,{block:"",class:"w-full","prepend-icon":"mdi-window-close",size:"x-large",color:"error",onClick:e[13]||(e[13]=a=>K())},{default:n(()=>[r(u(s(p)("Exit")),1)]),_:1})])):V("",!0)])]),_:1})]),_:1})}}},He=ee(Te,[["__scopeId","data-v-6c09660a"]]);export{He as default};
